import GtfsRealtimeBindings from"gtfs-realtime-bindings";export class GtfsRealtimeFetcher{constructor(){this.url="https://proxy.transport.data.gouv.fr/resource/ilevia-lille-gtfs-rt",this.updateCallback=null,this.errorCallback=null,this.intervalId=null}async fetchData(){try{const t=await fetch(this.url);if(!t.ok)throw new Error(`Erreur: ${t.status} ${t.statusText}`);const r=await t.arrayBuffer(),e=GtfsRealtimeBindings.transit_realtime.FeedMessage.decode(new Uint8Array(r));this.updateCallback&&this.updateCallback(e.entity)}catch(t){this.errorCallback&&this.errorCallback("Erreur lors de la récupération des données GTFS-RT: "+t)}}update(t){this.updateCallback=t}error(t){this.errorCallback=t}start(t=3e4){this.fetchData(),this.intervalId=setInterval(()=>this.fetchData(),t)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}}export function ToRealTime(t){return new Date(1e3*t).toLocaleString("fr-FR",{timeZone:"Europe/Paris",timeStyle:"short",dateStyle:"medium"})}export async function IdToStationInfo(t){try{let r=await fetch("https://data.lillemetropole.fr/data/ogcapi/collections/ilevia:arret_point/items?f=json&limit=-1");if(!r.ok)throw new Error(`Erreur: ${r.status} ${r.statusText}`);let e=await r.json(),a=await e.records;return await a.find(r=>r.stop_id===t)}catch(t){throw new Error(`Erreur: ${t}`)}}